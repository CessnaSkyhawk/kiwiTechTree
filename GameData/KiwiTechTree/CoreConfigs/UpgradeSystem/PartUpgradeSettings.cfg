// Kiwi's Tech Tree Overhaul (Partupgrade Settings)
// Version 2.0
// Created: 22 November 2020 for KSP 1.9.1 to 1.10.1
// Last Updated: 19 July 2021 for KSP 1.12.1
// 24 November 2020: Consolidated the upgrade settings to one patch to reduce the number of patches impacting all parts.
// 2 January 2021: Removed add cost to part upgrades as plugin colors upgrades to distinguish from parts.
// 19 July 2021: Moved engine, RCS and Strucutal upgrade settings here for consistency.
// Special thanks to flart for the suggestion.

//// General Patches for catch all \\\\
@PART[*]:FOR[KiwiTechTree]
{
	multiplierProcessed = no

	batteryUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/BATTERY$
	fuelTankUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/FUELTANK$
	parachuteUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/PARACHUTE$
	sasUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/SAS$
	solarUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/SOLAR$
	spaceCapableUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/SPACECAPABLE$
	systemUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/SYSTEM$
	kerbalengineerUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/KERBALENGINEER$
}


//// Battery Patches \\\\
@PARTUPGRADE[*]:HAS[#type[battery]]:FOR[KiwiTechTree]
{
	batteryUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/BATTERY$
}

// Deletes the unused part upgrades
!PARTUPGRADE[*]:HAS[#batteryUpgrade[off]]:LAST[KiwiTechTree] {}





//// Engine Patches \\\\
@PART[*]:HAS[@MODULE[ModuleEngines*]]:FOR[KiwiTechTree]
{
	engineUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/ENGINE$
}

@PARTUPGRADE[*]:HAS[#type[engine]]:FOR[KiwiTechTree]
{
	engineUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/ENGINE$
}

// Deletes the unused part upgrades
!PARTUPGRADE[*]:HAS[#engineUpgrade[off]]:LAST[KiwiTechTree] {}



//// Fueltank Patches \\\\
// Set this so any part that will go through my custom Cryotanks fuel switch will be ignored
@PART[*]:HAS[#fuelTankUpgrade[off],#kiwiTankUpgradeType]:AFTER[zKiwiTechTree]
{
	%KiwiFuelSwitchIgnore = true
}

@PARTUPGRADE[*]:HAS[#type[fuelTank]]:FOR[KiwiTechTree]
{
	fuelTankUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/FUELTANK$
}

// Deletes the unused part upgrades
!PARTUPGRADE[*]:HAS[#fuelTankUpgrade[off]]:LAST[KiwiTechTree] {}




//// Parachute Patches \\\\
@PARTUPGRADE[*]:HAS[#type[parachute]]:FOR[KiwiTechTree]
{
	parachuteUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/PARACHUTE$
}

// Deletes the unused part upgrades
!PARTUPGRADE[*]:HAS[#parachuteUpgrade[off]]:LAST[KiwiTechTree] {}





//// RCS Patches \\\\
@PART[*]:HAS[@MODULE[ModuleRCSFX]]:FOR[KiwiTechTree]
{
	rcsUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/RCS$
	rcsPrimaryUpgrade = #$@KIWI_RCS_SETTINGS/PRIMARY$
	rcsColdGasUpgrade = #$@KIWI_RCS_SETTINGS/COLDGAS$
}

@PART[*]:HAS[@RESOURCE[MonoPropellant]]:FOR[KiwiTechTree]
{
	rcsUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/RCS$
	rcsPrimaryUpgrade = #$@KIWI_RCS_SETTINGS/PRIMARY$
	rcsColdGasUpgrade = #$@KIWI_RCS_SETTINGS/COLDGAS$
}

@PARTUPGRADE[*]:HAS[#type[rcs]]:FOR[KiwiTechTree]
{
	rcsUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/RCS$
}

// Deletes the unused part upgrades
!PARTUPGRADE[*]:HAS[#rcsUpgrade[off]]:LAST[KiwiTechTree] {}






//// SAS Patches \\\\
@PARTUPGRADE[*]:HAS[#type[sas]]:FOR[KiwiTechTree]
{
	sasUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/SAS$
}

// Deletes the unused part upgrades
!PARTUPGRADE[*]:HAS[#sasUpgrade[off]]:LAST[KiwiTechTree] {}






//// Solar Patches \\\\
@PARTUPGRADE[*]:HAS[#type[solar]]:FOR[KiwiTechTree]
{
	solarUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/SOLAR$
}

// Deletes the unused part upgrades
!PARTUPGRADE[*]:HAS[#solarUpgrade[off]]:LAST[KiwiTechTree] {}



//// SpaceCapable Patches \\\\
@PARTUPGRADE[*]:HAS[#type[spaceCapable]]:FOR[KiwiTechTree]
{
	spaceCapableUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/SPACECAPABLE$
}

// Deletes the unused part upgrades
!PARTUPGRADE[*]:HAS[#spaceCapableUpgrade[off]]:LAST[KiwiTechTree] {}



//// SpaceCapable Patches \\\\
// Set this so any part that will go through my custom Cryotanks fuel switch will be ignored
@PART[*]:HAS[#systemUpgrade[off],#kiwiSystemUpgradeType]:AFTER[zKiwiTechTree]
{
	%KiwiFuelSwitchIgnore = true
}

@PARTUPGRADE[*]:HAS[#type[system]]:FOR[KiwiTechTree]
{
	systemUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/SYSTEM$
}

// Deletes the unused part upgrades
!PARTUPGRADE[*]:HAS[#systemUpgrade[off]]:LAST[KiwiTechTree] {}



//// Structural Patches \\\\
@PART[*]:FOR[KiwiTechTree]
{
	structuralUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/STRUCTURAL$
}

@PARTUPGRADE[*]:HAS[#type[structural]]:FOR[KiwiTechTree]
{
	structuralUpgrade = #$@KIWI_GENERAL_SETTINGS/UPGRADES/STRUCTURAL$
}

// Deletes the unused part upgrades
!PARTUPGRADE[*]:HAS[#structuralUpgrade[off]]:LAST[KiwiTechTree] {}