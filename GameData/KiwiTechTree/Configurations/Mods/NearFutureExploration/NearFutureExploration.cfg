// Kiwi's Tech Tree Overhaul (Near Future Exploration 1.0.10 by Nertea Patch)
// Version 1.0
// Created: September 2020 for KSP 1.9.1
// Last Updated: 26 October 2020
// 18 October 2020: Moved reaction wheel to basicRocketry to reflect changes in flight control. 
// 21 October 2020: Moved lower power antenna earlier in the tech tree.
// 26 October 2020: Changed KiwiAerospace to KiwiTechTree
// 14 November 2020: Moved TDRS-1 to correct tier

// Miscellanous
@PART[nfex-battery-mini-1]:AFTER[NearFutureExploration] // Z-25 Rechargeable Battery
{
  @TechRequired = engineering101
}

//// ********* Probes and Communication ********* \\\\

// ***** Probes ***** \\

// Tier 0 - start

// Tier 1 - basicRocketry
@PART[nfex-reaction-wheel-mini-1]:AFTER[NearFutureExploration] // Tiny Reaction Wheel
{
  @TechRequired = basicRocketry
}

// Tier 2 - science201
@PART[nfex-*-okto-*]:AFTER[NearFutureExploration] // Probodobodyne OKTO Series Probes and Busses
{
	@TechRequired = science201
}

// Tier 3 - basicScience
@PART[nfex-*-hecs-*]:AFTER[NearFutureExploration] // Probodobodyne HECS Series Probes and Busses
{
	@TechRequired = basicScience
}

// Tier 4 - earlyProbes
@PART[nfex-*-qbe-*]:AFTER[NearFutureExploration] // Probodobodyne QBE Series Probes and Busses
{
  @TechRequired = earlyProbes
}

// Tier 5 - communicationSatellites
@PART[nfex-*-rekt-*]:AFTER[NearFutureExploration] // Probodobodyne REKT Series Probes and Busses
{
  @TechRequired = communicationSatellites
}
@PART[nfex-*-rkt-*]:AFTER[NearFutureExploration] // Probodobodyne REKT Series Probes and Busses
{
  @TechRequired = communicationSatellites
}

// Tier 6 - unmannedTech
@PART[nfex-*-rnd-*]:AFTER[NearFutureExploration] // Probodobodyne RND Series Probes and Busses
{
  @TechRequired = unmannedTech
}
@PART[nfex-*-stp-*]:AFTER[NearFutureExploration] // Probodobodyne STP Series Probes and Busses
{
  @TechRequired = unmannedTech
}

// Tier 7 - advUnmanned or automation
@PART[nfex-*-dsk-*]:AFTER[NearFutureExploration] // Probodobodyne DSK Series Probes and Busses
{
	@TechRequired = advUnmanned
}
@PART[nfex-*-hecs2-*]:AFTER[NearFutureExploration] // Probodobodyne HECS2 Series Probes and Busses
{
	@TechRequired = advUnmanned
}
@PART[nfex-*-adtp-*]:AFTER[NearFutureExploration] // Probodobodyne ADTP Series Probes and Busses
{
  @TechRequired = advUnmanned
}

// Tier 8 - largeUnmanned or mechatronics
@PART[nfex-*-cyl-*]:AFTER[NearFutureExploration] // Probodobodyne CYL Series Probes and Busses
{
	@TechRequired = largeUnmanned // Doesn't Change
}

// Tier 9 - artificialIntelligence
@PART[nfex-*-chfr-*]:AFTER[NearFutureExploration] // Probodobodyne CHFR Series Probes and Busses
{
  @TechRequired = artificialIntelligence
}

@PART[nfex-*-sqr-*]:AFTER[NearFutureExploration] // Probodobodyne SQR Series Probes and Busses
{
  @TechRequired = artificialIntelligence
}
@PART[nfex-*-plto-*]:AFTER[NearFutureExploration] // Probodobodyne PLTO Series Probes and Busses
{
  @TechRequired = artificialIntelligence
}

// ***** Antenna ***** \\

// Tier 0 - start
@PART[nfex-antenna-rover-1]:AFTER[NearFutureExploration] // 40K Direct
{
	@cost = 200 // A bit cheaper
	@TechRequired = start // Think this makes more sense to have rather than the Communotron 16-S 
	@mass *= 0.2 // Seems really "sturdy" at 90+ kg otherwise.
}

// Tier 1 - engineering101
@PART[nfex-antenna-rover-2]:AFTER[NearFutureExploration] // 150K Direct
{
	@TechRequired = engineering101
}
@PART[nfex-antenna-phased-single-1]:AFTER[NearFutureExploration] // 125K Direct
{
	@TechRequired = engineering101
}

// Tier 2 - science201


// Tier 3 - basicScience
@PART[nfex-antenna-reflector-side-1]:AFTER[NearFutureExploration] // 9M Reflector
{
	@TechRequired = basicScience
}
@PART[nfex-antenna-phased-single-2]:AFTER[NearFutureExploration] // Direct 200K
{
	@TechRequired = basicScience
}

@PART[nfex-antenna-static-mini-1]:AFTER[NearFutureExploration] // Direct 300K
{
	@TechRequired = basicScience // Doesn't Change
}

// Tier 4 - earlyProbes

@PART[nfex-antenna-rover-3]:AFTER[NearFutureExploration] // 300K Direct
{
	@TechRequired = earlyProbes
}

@PART[nfex-antenna-deploy-wv3-1]:AFTER[NearFutureExploration] // 500K Direct
{
	@TechRequired = earlyProbes
}

@PART[nfex-antenna-phased-single-3]:AFTER[NearFutureExploration] // 800K Direct
{
	@TechRequired = earlyProbes
}

@PART[nfex-antenna-reflector-side-2]:AFTER[NearFutureExploration] // 75M Reflector
{
	@TechRequired = earlyProbes
}



// Tier 5 - communicationSatellites
@PART[nfex-antenna-feeder-direct-1]:AFTER[NearFutureExploration] // 5K Direct
{
	@TechRequired = communicationSatellites
}
@PART[nfex-antenna-feeder-relay-1]:AFTER[NearFutureExploration] // 5K Relay
{
	@TechRequired = communicationSatellites
}


@PART[nfex-antenna-relay-tiny-1]:AFTER[NearFutureExploration] // 2M Relay
{
	@TechRequired = communicationSatellites
}

@PART[nfex-antenna-top-dish-1]:AFTER[NearFutureExploration] // 2M Direct
{
	@TechRequired = communicationSatellites
}

@PART[nfex-antenna-reflector-side-3]:AFTER[NearFutureExploration] // 850M Reflector
{
	@TechRequired = communicationSatellites
}
@PART[nfex-antenna-relay-tdrs-1]:AFTER[NearFutureExploration] // 85M Relay
{
	@TechRequired = communicationSatellites
}



// Tier 6 - highGainCommunications


@PART[nfex-antenna-phased-array-1]:AFTER[NearFutureExploration] // 6M Direct
{
	@TechRequired = highGainCommunications
}

@PART[nfex-antenna-top-dish-2]:AFTER[NearFutureExploration] // 50M Direct
{
	@TechRequired = highGainCommunications
}

@PART[nfex-antenna-reflector-large-1]:AFTER[NearFutureExploration] // 9G Reflector
{
	@TechRequired = highGainCommunications
}

@PART[nfex-antenna-relay-tdrs-2]:AFTER[NearFutureExploration] // 500M Relay
{
	@TechRequired = highGainCommunications
}


// Tier 7 - signalProcessing
@PART[nfex-antenna-phased-array-2]:AFTER[NearFutureExploration] // 50M Direct High Speed
{
	@TechRequired = signalProcessing
}

// Tier 8 - digitalSignalProcessing
@PART[nfex-antenna-phased-array-3]:AFTER[NearFutureExploration] // 100M Direct High Speed
{
	@TechRequired = digitalSignalProcessing
}

@PART[nfex-antenna-reflector-huge-1]:AFTER[NearFutureExploration] // 100G Reflector
{
	@TechRequired = digitalSignalProcessing
}

// Tier 9 - xBandCommunications

// Tier 10 - deepSpaceOpticalCommunications
@PART[nfex-antenna-reflector-giant-1]:AFTER[NearFutureExploration] // 5T Reflector
{
	@TechRequired = deepSpaceOpticalCommunications
}

// Tier 11 - quantumCommunications




// Fuel Tanks
// Move all the fuel tanks to the flexible fuel solutions node
@PART[nfex-fueltank-*]:AFTER[NearFutureExploration]
{
	@TechRequired = flexibleFuelSolutions
}

// Add Methane and Methalox Fuel to these if CryoTanksMethalox installed
@PART[nfex-fueltank-stack-medium-1]:NEEDS[CryoTanksMethalox]:FOR[zKiwiTechTree]
{
  @MODULE[ModuleB9PartSwitch]:HAS[#moduleID[surfaceSwitch]]
  {
    SUBTYPE
    {
      name = Methane
      transform = Tank1875_Large_Foil
      title = Methane
      descriptionSummary = Liquid Methane
      primaryColor = #fccb0a
      secondaryColor = #fccb0a
      tankType = LM
      addedMass = -0.05
    }
    SUBTYPE
    {
      name = Methalox
      transform = Tank1875_Large_Foil
      title = Methalox
      descriptionSummary = Liquid Methane and Oxidizer
      primaryColor = #fccb0a
      secondaryColor = #fccb0a
      tankType = LMOx
      addedMass = -0.05
    }
  }
}

@PART[nfex-fueltank-stack-medium-2]:NEEDS[CryoTanksMethalox]:FOR[zKiwiTechTree]
{
  @MODULE[ModuleB9PartSwitch]:HAS[#moduleID[surfaceSwitch]]
  {
    SUBTYPE
    {
      name = Methane
      transform = Tank1875_Med_Foil
      title = Methane
      descriptionSummary = Liquid Methane
      primaryColor = #fccb0a
      secondaryColor = #fccb0a
      tankType = LM
      addedMass = -0.035
    }
    SUBTYPE
    {
      name = Methalox
      transform = Tank1875_Med_Foil
      title = Methalox
      descriptionSummary = Liquid Methane and Oxidizer
      primaryColor = #fccb0a
      secondaryColor = #fccb0a
      tankType = LMOx
      addedMass = -0.035
    }

  }
}

@PART[nfex-fueltank-stack-medium-3]:NEEDS[CryoTanksMethalox]:FOR[zKiwiTechTree]
{
 @MODULE[ModuleB9PartSwitch]:HAS[#moduleID[surfaceSwitch]]
  {
    SUBTYPE
    {
      name = Methane
      transform = Tank1875_Short_Foil
      title = Methane
      descriptionSummary = Liquid Methane
      primaryColor = #fccb0a
      secondaryColor = #fccb0a
      tankType = LM
      addedMass = -0.0175
    }
    SUBTYPE
    {
      name = Methalox
      transform = Tank1875_Short_Foil
      title = Methalox
      descriptionSummary = Liquid Methane and Oxidizer
      primaryColor = #fccb0a
      secondaryColor = #fccb0a
      tankType = LMOx
      addedMass = -0.0175
    }
  }
}

@PART[nfex-fueltank-radial-small-1]:NEEDS[CryoTanksMethalox]:FOR[zKiwiTechTree]
{
 @MODULE[ModuleB9PartSwitch]:HAS[#moduleID[surfaceSwitch]]
 {
  SUBTYPE
  {
    name = Methane
    transform = Tank1875_RadialLarge_Foil
    title = Methane
    descriptionSummary = Liquid Methane
    primaryColor = #fccb0a
    secondaryColor = #fccb0a
    tankType = LM
    addedMass = -0.015
  }
  SUBTYPE
  {
    name = Methalox
    transform = Tank1875_RadialLarge_Foil
    title = Methalox
    descriptionSummary = Liquid Methane and Oxidizer
    primaryColor = #fccb0a
    secondaryColor = #fccb0a
    tankType = LMOx
    addedMass = -0.015
  }
 }
}

@PART[nfex-fueltank-radial-small-2]:NEEDS[CryoTanksMethalox]:FOR[zKiwiTechTree]
{
 @MODULE[ModuleB9PartSwitch]:HAS[#moduleID[surfaceSwitch]]
 {
  SUBTYPE
  {
    name = Methane
    transform = Tank1875_RadialMed_Foil
    title = Methane
    descriptionSummary = Liquid Methane
    primaryColor = #fccb0a
    secondaryColor = #fccb0a
    tankType = LM
    addedMass = -0.00625
  }
  SUBTYPE
  {
    name = Methalox
    transform = Tank1875_RadialMed_Foil
    title = Methalox
    descriptionSummary = Liquid Methane and Oxidizer
    primaryColor = #fccb0a
    secondaryColor = #fccb0a
    tankType = LMOx
    addedMass = -0.00625
  }
 }
}

@PART[nfex-fueltank-radial-small-3]:NEEDS[CryoTanksMethalox]:FOR[zKiwiTechTree]
{
 @MODULE[ModuleB9PartSwitch]:HAS[#moduleID[surfaceSwitch]]
 {
  SUBTYPE
  {
    name = Methane
    transform = Tank1875_RadialSmall_Foil
	title = Methane
    descriptionSummary = Liquid Methane
    primaryColor = #fccb0a
    secondaryColor = #fccb0a
    tankType = LM
    addedMass = -0.00325
  }
  SUBTYPE
  {
    name = Methalox
    transform = Tank1875_RadialSmall_Foil
    title = Methalox
    descriptionSummary = Liquid Methane and Oxidizer
    primaryColor = #fccb0a
    secondaryColor = #fccb0a
    tankType = LMOx
    addedMass = -0.00325
  }
 }
}

@PART[nfex-fueltank-radial-tiny-1]:NEEDS[CryoTanksMethalox]:FOR[zKiwiTechTree]
{
 @MODULE[ModuleB9PartSwitch]
 {
  SUBTYPE
  {
    name = Methane
    transform = ProbeTankRadial_GoldFoil
    title = Methane
    descriptionSummary = Liquid Methane
    primaryColor = #fccb0a
    secondaryColor = #fccb0a
    tankType = LM
    addedMass = -0.0015
  }
  SUBTYPE
  {
    name = Methalox
    transform = ProbeTankRadial_GoldFoil
    title = Methalox
    descriptionSummary = Liquid Methane and Oxidizer
    primaryColor = #fccb0a
    secondaryColor = #fccb0a
    tankType = LMOx
    addedMass = -0.0015
  }
 }
}
@PART[nfex-fueltank-stack-tiny-1]:NEEDS[CryoTanksMethalox]:FOR[zKiwiTechTree]
{
 @MODULE[ModuleB9PartSwitch]
 {
  SUBTYPE
  {
    name = Methane
    transform = ProbeTankMini_GoldFoil
    title = Methane
    descriptionSummary = Liquid Methane
    primaryColor = #fccb0a
    secondaryColor = #fccb0a
    tankType = LM
    addedMass = -0.00325
  }
  SUBTYPE
  {
    name = Methalox
    transform = ProbeTankMini_GoldFoil
    title = Methalox
    descriptionSummary = Liquid Methane and Oxidizer
    primaryColor = #fccb0a
    secondaryColor = #fccb0a
    tankType = LMOx
    addedMass = -0.00325
  }
 }
}