// Kiwi's Tech Tree Overhaul (Kerbal Planetary Base Systems by Nils277 Patch)
// Version 0.9
// Created: 30 September 2020 for KSP 1.9.1
// Last Updated: 29 October 2020
// 26 October 2020: Changed KiwiAerospace to KiwiTechTree
// 29 October 2020: Generalized the ModuleEngines Identifier in B9

//// ********* Logistics and Station/Moon Habitation ********* \\\\
// ***** Stations / Colony Pieces ***** \\

// Tier 0 - start

// Tier 1 - engineering101

// Tier 2 - serviceModules

// Tier 3 - skipped

// Tier 4 - recycling

// Tier 5 - hydroponics

// Tier 6 - earlyStations

// Tier 7 - shortTermHabitation

// Tier 8 - longTermHabitation
@PART[KKAOSS_Central_Hub]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = longTermHabitation
	@RESOURCE[ElectricCharge]
	{
		@amount = 750
		@maxAmount = 750
	}
}

@PART[KKAOSS_Control_g]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = longTermHabitation
	@RESOURCE[ElectricCharge]
	{
		@amount = 450
		@maxAmount = 450
	}
}

@PART[KKAOSS_Cupola_g|KKAOSS_Science_g|KKAOSS_Greenhouse_g|KKAOSS_Habitat_MK2_g|KKAOSS_Habitat_MK1_g]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = longTermHabitation
}

// Tier 9 - advancedStations

// Tier 10 - colonization

// Tier 11 - advColonization



// ***** Storage/Resources ***** \\
// Tier 0 - start

// Tier 1 - engineering101

// Tier 2 - serviceModules

// Tier 3 - Skipped

// Tier 4 - storageTech
@PART[KKAOSS_Service_g|KKAOSS_Storage_mini_g|KKAOSS_Ore_Tank|KKAOSS_Small_Ore_Tank]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = storageTech
}

// Tier 5 - earlyLogistics

// Tier 6 - logistics
@PART[KKAOSS_Storage_size2_s]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = logistics
}

// Tier 7 - isru

// Tier 8 - advLogistics
@PART[KKAOSS_Centrifuge|KKAOSS_ISRU_g|KKAOSS_drill|KKAOSS_Storage_g|KKAOSS_Storage_mid_g|KKAOSS_Storage_size2_m]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = advLogistics
}

// Tier 9 - advOffworldMining

// Tier 10 - resourceExploitation


// ***** Thermals including Heat Shields ***** \\

// Tier 0 - start

// Tier 1 - engineering101

// Tier 2 - science201

// Tier 3 - batteryTech

// Tier 4 - electrics

// Tier 5 - heatManagementSystems

// Tier 6 - intermediateHeatManagement
@PART[KKAOSS_base_heatshield]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = intermediateHeatManagement
}

// Tier 7 - advHeatManagement

// Tier 8 - experimentalHeatManagement


// Tier 9 - specializedRadiators


//// ********* Construction ********* \\\\

// ***** Adapters, Fairings, Rocket Nose Cones ***** \\
// Tier 0 - start

// Tier 1 - basicRocketry

// Tier 2 - basicConstruction

// Tier 3 - generalConstruction

// Tier 4 - Advanced Construction - advConstruction

// Tier 5 - Specialized Construction - specializedConstruction

// Tier 6 - Advanced MetalWorks - advMetalworks
@PART[KKAOSS_base_tricupler|KKAOSS_base_bicupler|KKAOSS_adapter_base_to_Size1_g|KKAOSS_adapter_base_to_MK2_g|KKAOSS_garage_adapter_g_2|KKAOSS_garage_adapter_size3_g]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = advMetalworks
}

// Tier 7 - Nanolathing - nanolathing

// Tier 8 - Exotic Alloys - exoticAlloys

// Tier 9 - aerographite


// ***** Structural Parts ***** \\
// Tier 0 - start

// Tier 1 - Basic Rocketry - basicRocketry

// Tier 2 - Basic Construction - basicConstruction

// Tier 3 - General Construction - generalConstruction

// Tire 4 - Advanced Construction - advConstruction

// Tier 5 - Specialized Construction - specializedConstruction
@PART[KKAOSS_Flatbed]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = specializedConstruction
}

// Tier 6 - Composites - composites

// Tier 7 - Meta-Materials - metaMaterials

// Tier 8 - Orbital Assembly - orbitalAssembly
@PART[KKAOSS_gangway_end|KKAOSS_gangway_airlock|KKAOSS_corridor_6|KKAOSS_corridor_4|KKAOSS_gangway_2_adapter|KKAOSS_CrossSection_g|KKAOSS_airlock_mid_g|KKAOSS_airlock_end_g|KKAOSS_garage_cover_g_2|KKAOSS_garage_front_g_2|KKAOSS_garage_side_g_2|KKAOSS_garage_struct_g_2|KKAOSS_Storage_End_Cap_Storage]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = orbitalAssembly
}

// Tier 9 - Orbital Megastructures - orbitalMegastructures


//// ********* Decouplers/Separators/DockingPorts/EnginePlates ********* \\\\

// Tier 0

// Tier 1

// Tier 2 Basic Construction - basicConstruction

// Tier 3 Decoupling - decoupling

// Tier 4 Docking - docking

// Tier 5 Advanced Decoupling -advancedDecoupling

// Tier 6 Engine Plates - enginePlates
@PART[KKAOSS_garage_decoupler_g|KKAOSS_base_separator|KKAOSS_dock_habitat|KKAOSS_dock_gangway]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = enginePlates
}

// Tier 7 Advanced Docking - advancedDocking

// Tier 8 Advanced Engine Plates - advancedEnginePlates

// Tier 9 Automated Decoupling Systems - automatedDecouplingSystems

// Tier 10 extremeFuelStorage


// ***** Speciality Liquid Fuel Tanks ***** \\

// Tier 3 - fuelLines

// Tier 4 - flexibleFuelSolutions

// Tier 5 - advancedFlexibleFuelSolutions
@PART[KKAOSS_Fuel_Tank_small|KKAOSS_Fuel_Tank|KKAOSS_adapter_g|KKAOSS_Liquid_Fuel_Tank|KKAOSS_Rocket_Fuel_Tank|KKAOSS_small_Rocket_Fuel_Tank]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = advancedFlexibleFuelSolutions
}


// Tier 7 - nobleGasFuelSystems
@PART[KKAOSS_Xenon_Tank]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = nobleGasFuelSystems
}


//// ********* Engines ********* \\\\

// ***** Liquid Fuel ***** \\

// Tier 0 - start, just the small jet engine to allow for the aeronautics branch

// Tier 1 - basicRocketry , a basic 0.625m engine that helps get us off the ground

// Tier 2 - generalRocketry ; Stronger 0.625m engine and initial 1.25m engine

// Tier 3 - advRocketry ; Intro of the 1.875m engine in Making History

// Tier 4 - heavyRocketry Heavy Rocketry, Intro of 2.5m engines

// Tier 5 - heavierRocketry Heavier Rocketry

// Tier 6 - evenHeavierRocketry Even Heavier Rocketry Intro of 3.75m engines
@PART[KKAOSS_engine_g]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = evenHeavierRocketry
	@description = #$description$ \n\n<color=#ff0000>This part has upgrades!</color> 
	upgradedThrust0 = #$MODULE[ModuleEnginesFX],0/maxThrust$
	@upgradedThrust0 *= 1.2
	@entryCost = 25000
	@cost = 1700
	
	%addCost = #$cost$
	@addCost *= 0.5
	
	%addMass = #$mass$
	@addMass *= 0.1
	
	// These are technically the same, but want to leave it open to alter in the future
	key00 = #$MODULE[ModuleEnginesFX],0/atmosphereCurve/key,0$
	@key00[1, ] *= 1.1
	key10 = #$MODULE[ModuleEnginesFX],0/atmosphereCurve/key,1$
	@key10[1, ] *= 1.1
	key20 = #$MODULE[ModuleEnginesFX],0/atmosphereCurve/key,2$
	@key20[1, ] *= 1.1
	//key30 = #$MODULE[ModuleEnginesFX],0/atmosphereCurve/key,3$
	//@key30[1, ] *= 1.1
	//key40 = #$MODULE[ModuleEnginesFX],0/atmosphereCurve/key,4$
	//@key40[1, ] *= 1.1
	
	
	MODULE
	{
		name = ModuleB9PartSwitch
		moduleID = engineSwitch
		switcherDescriptionPlural = Engine Models
		switcherDescription = Engine Switch

		affectDragCubes = False
		affectFARVoxels = False
		
		SUBTYPE
	    {
			name = original
			title = #$../../title$
			descriptionSummary = Original Model.
			descriptionDetail = <b>Thrust:</b> 65.6 kN ASL / 75.0 kN Vac.\n<b>Isp:</b> 280.0 s ASL / 320.0 s Vac.
			addedCost = 0
			defaultSubtypePriority = 1
			primaryColor = #3cff00
			secondaryColor = #bfa760
	    }
		
		SUBTYPE
	    {
			name = upgrade
			title = #$../../title$
			@title ^= :25:25Q:
			@title ^= :Meerkat:Phacochoerus:
			descriptionSummary = 20% Increased Thrust, 10% Increased Specific Impulse.
			descriptionDetail = <b>Thrust:</b> 78.8 kN ASL / 90.0 kN Vac.\n<b>Isp:</b> 308.0 s ASL / 352.0 s Vac.
			upgradeRequired = meerkatUpgrade
			addedCost = #$../../addCost$
			addedMass = #$../../addMass$
			defaultSubtypePriority = 0
			primaryColor = #218e00
			secondaryColor = #bfa760

			MODULE
			{
			    IDENTIFIER
			    {
					name = ModuleEngines*
			    }

			    DATA
			    {
					maxThrust = #$../../../../upgradedThrust0$
					atmosphereCurve
					{
						key = #$../../../../../key00$
						key = #$../../../../../key10$
						key = #$../../../../../key20$
					}
				}			    
			}
	    }
	}
}

// Tier 7 - veryHeavyRocketry Very Heavy Rocketry

// Tier 8 - experimentalRocketry Experimental Rocketry

// Tier 9 - giganticRocketry

// Tier 10 - colossalRocketry


// ***** Flight Control: Monopropellant Tanks, RCS Thrusters, SAS Modules, Launch Escape Systems ***** \\
// Tier 0 - Start

// Tier 1 - earlyFlight

// Tier 2 - stability or survivability for SAS

// Tier 3 - flightControl

// Tier 4 - advFlightControl

// Tier 5 - specializedControl
@PART[KKAOSS_RCS_Tank]:NEEDS[PlanetaryBaseInc]:FOR[zKiwiTechTree]
{
	@TechRequired = specializedControl
}

// Tier 6 - experimentalControl

// Tier 7 - exoticControl

