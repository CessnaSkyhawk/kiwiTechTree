// Kiwi's Tech Tree Overhaul (Structural Parts Stock Upgrades)
// Version 1.2
// Created: 26 August 2020 for KSP 1.9.1 to 1.10.1
// Last Updated: 23 November 2020
// 28 September 2020: Added a template for Even Later Tier9+ Structural Upgrades which was otherwise only used for Near Future Space Craft and Launch Vehicles as a just in case.
// 21 October 2020: Added a Coatl Aerospace Structural part as too lazy to add a new config just for that.
// 26 October 2020: Changed KiwiAerospace to KiwiTechTree
// 27 October 2020: Added support for general upgrades via declaring a variable
// 1 November 2020: Further generalized the structural upgrade code
// 2 November 2020: Added patch to identify the location of the upgrade found in the description!
// 11 November 2020: Removed legacy structural part upgrades
// 23 November 2020: Added toggle for structural parts upgrades
// 12 December 2020: Made it easier to identify the name of structural upgrades. 

// Structural Pieces
@PART[*]:HAS[#kiwiStructuralUpgradeType,~structuralUpgrade[off]]:FOR[zzKiwiTechTree]
{
	//Dry Mass
	%dryMass = #$mass$
	@dryMass *= #$@KIWI_STRUCTURAL_MULTIPLIERS/STRUCTURAL/UPGRADE_MASS_MULTIPLIER$
	@dryMass *= -1
	
	// Long Equations
	%costAdjust = #$cost$
	@costAdjust *= #$@KIWI_STRUCTURAL_MULTIPLIERS/STRUCTURAL/UPGRADE_COST_MULTIPLIER$
	
	
	MODULE
	{
		name = ModuleB9PartSwitch
		moduleID = materialSwitch
		switcherDescription = Material Switch
		affectDragCubes = False
		affectFARVoxels = False
		
		SUBTYPE
	    {
			name = Baseline
			title = #LOC_KTT_B9TITLE_BASELINE_MATERIAL // Baseline Material
			descriptionSummary =
			descriptionDetail =
			addedCost = 0
			defaultSubtypePriority = 1
			primaryColor = #fb8e8e
			secondaryColor = #fb8e8e
	    }
		
		SUBTYPE
	    {
			name = Improved
			title = 	#LOC_KTT_B9TITLE_UPGRADE_MATERIAL // Composite Material
			descriptionSummary = 
			descriptionDetail = #LOC_KTT_PARTUPGRADE_BASICINFO_SYSTEM // Reduced Dry Mass
			upgradeRequired = #$../../kiwiStructuralUpgradeType$StructuralUpgrade
			addedCost = #$../../costAdjust$
			addedMass = #$../../dryMass$
			defaultSubtypePriority = 0
			primaryColor = #c74c4c
			secondaryColor = #c74c4c
	    }		
	}	
}

PARTUPGRADE:NEEDS[Squad]
{
    type = structural
    name = tier0StructuralUpgrade
    partIcon = winglet
    techRequired = earlyConstruction
    entryCost = 25000
    cost = 0
    title = #LOC_KTT_PARTUPGRADE_TITLE_SYSTEM // INSERTPARTTITLE Upgrade
    basicInfo = #LOC_KTT_PARTUPGRADE_BASICINFO_SYSTEM // Decrease in Dry Mass
    manufacturer = #LOC_KTT_PARTUPGRADE_MANUFACTURER // Kiwi Imagineers
    description = #LOC_KTT_PARTUPGRADE_DESCRIPTION_SYSTEM // The imagineers have introduced composite materials that have reduced the dry mass of the INSERTSYSTEM!
}
@PARTUPGRADE[tier0StructuralUpgrade]:NEEDS[Squad]
{
    @title ^= :INSERTPARTTITLE:Tier 0 Structural Parts:
    @description ^= :INSERTSYSTEM:Tier 0 Structural Parts:
}
@PART[*]:HAS[#kiwiStructuralUpgradeType[tier0],~structuralUpgrade[off]]:FOR[zzzKiwiTechTree]
{
    %descriptionUpgrade = #LOC_KTT_PART_DESCRIPTIONUPGRADE_SYSTEM // The INSERTSYSTEMUPGRADENAME has upgrades in INSERTSYSTEMUPGRADENODE!
    @description = #$description$ \n\n<color=#ff0000>$descriptionUpgrade$</color>
    @description ^= :INSERTSYSTEMUPGRADENAME:Tier 0 Structural Parts:
    @description ^= :INSERTSYSTEMUPGRADENODE:Early Construction (Tier 2):
}
PARTUPGRADE:NEEDS[Squad]
{
    type = structural
    name = tier1StructuralUpgrade
    partIcon = winglet
    techRequired = basicConstruction
    entryCost = 50000
    cost = 0
    title = #LOC_KTT_PARTUPGRADE_TITLE_SYSTEM // INSERTPARTTITLE Upgrade
    basicInfo = #LOC_KTT_PARTUPGRADE_BASICINFO_SYSTEM // Decrease in Dry Mass
    manufacturer = #LOC_KTT_PARTUPGRADE_MANUFACTURER // Kiwi Imagineers
    description = #LOC_KTT_PARTUPGRADE_DESCRIPTION_SYSTEM // The imagineers have introduced composite materials that have reduced the dry mass of the INSERTSYSTEM!
}
@PARTUPGRADE[tier1StructuralUpgrade]:NEEDS[Squad]
{
    @title ^= :INSERTPARTTITLE:Tier 1 Structural Parts:
    @description ^= :INSERTSYSTEM:Tier 1 Structural Parts:
}
@PART[*]:HAS[#kiwiStructuralUpgradeType[tier1],~structuralUpgrade[off]]:FOR[zzzKiwiTechTree]
{
    %descriptionUpgrade = #LOC_KTT_PART_DESCRIPTIONUPGRADE_SYSTEM // The INSERTSYSTEMUPGRADENAME has upgrades in INSERTSYSTEMUPGRADENODE!
    @description = #$description$ \n\n<color=#ff0000>$descriptionUpgrade$</color>
    @description ^= :INSERTSYSTEMUPGRADENAME:Tier 1 Structural Parts:
    @description ^= :INSERTSYSTEMUPGRADENODE:Basic Construction (Tier 3):
}
PARTUPGRADE:NEEDS[Squad]
{
    type = structural
    name = tier2StructuralUpgrade
    partIcon = winglet
    techRequired = generalConstruction
    entryCost = 75000
    cost = 0
    title = #LOC_KTT_PARTUPGRADE_TITLE_SYSTEM // INSERTPARTTITLE Upgrade
    basicInfo = #LOC_KTT_PARTUPGRADE_BASICINFO_SYSTEM // Decrease in Dry Mass
    manufacturer = #LOC_KTT_PARTUPGRADE_MANUFACTURER // Kiwi Imagineers
    description = #LOC_KTT_PARTUPGRADE_DESCRIPTION_SYSTEM // The imagineers have introduced composite materials that have reduced the dry mass of the INSERTSYSTEM!
}
@PARTUPGRADE[tier2StructuralUpgrade]:NEEDS[Squad]
{
    @title ^= :INSERTPARTTITLE:Tier 2 Structural Parts:
    @description ^= :INSERTSYSTEM:Tier 2 Structural Parts:
}
@PART[*]:HAS[#kiwiStructuralUpgradeType[tier2],~structuralUpgrade[off]]:FOR[zzzKiwiTechTree]
{
    %descriptionUpgrade = #LOC_KTT_PART_DESCRIPTIONUPGRADE_SYSTEM // The INSERTSYSTEMUPGRADENAME has upgrades in INSERTSYSTEMUPGRADENODE!
    @description = #$description$ \n\n<color=#ff0000>$descriptionUpgrade$</color>
    @description ^= :INSERTSYSTEMUPGRADENAME:Tier 2 Structural Parts:
    @description ^= :INSERTSYSTEMUPGRADENODE:General Construction (Tier 4):
}
PARTUPGRADE:NEEDS[Squad]
{
    type = structural
    name = tier3StructuralUpgrade
    partIcon = winglet
    techRequired = advConstruction
    entryCost = 100000
    cost = 0
    title = #LOC_KTT_PARTUPGRADE_TITLE_SYSTEM // INSERTPARTTITLE Upgrade
    basicInfo = #LOC_KTT_PARTUPGRADE_BASICINFO_SYSTEM // Decrease in Dry Mass
    manufacturer = #LOC_KTT_PARTUPGRADE_MANUFACTURER // Kiwi Imagineers
    description = #LOC_KTT_PARTUPGRADE_DESCRIPTION_SYSTEM // The imagineers have introduced composite materials that have reduced the dry mass of the INSERTSYSTEM!
}
@PARTUPGRADE[tier3StructuralUpgrade]:NEEDS[Squad]
{
    @title ^= :INSERTPARTTITLE:Tier 3 Structural Parts:
    @description ^= :INSERTSYSTEM:Tier 3 Structural Parts:
}
@PART[*]:HAS[#kiwiStructuralUpgradeType[tier3],~structuralUpgrade[off]]:FOR[zzzKiwiTechTree]
{
    %descriptionUpgrade = #LOC_KTT_PART_DESCRIPTIONUPGRADE_SYSTEM // The INSERTSYSTEMUPGRADENAME has upgrades in INSERTSYSTEMUPGRADENODE!
    @description = #$description$ \n\n<color=#ff0000>$descriptionUpgrade$</color>
    @description ^= :INSERTSYSTEMUPGRADENAME:Tier 3 Structural Parts:
    @description ^= :INSERTSYSTEMUPGRADENODE:Advanced Construction (Tier 5):
}
PARTUPGRADE:NEEDS[Squad]
{
    type = structural
    name = tier4StructuralUpgrade
    partIcon = winglet
    techRequired = specializedConstruction
    entryCost = 200000
    cost = 0
    title = #LOC_KTT_PARTUPGRADE_TITLE_SYSTEM // INSERTPARTTITLE Upgrade
    basicInfo = #LOC_KTT_PARTUPGRADE_BASICINFO_SYSTEM // Decrease in Dry Mass
    manufacturer = #LOC_KTT_PARTUPGRADE_MANUFACTURER // Kiwi Imagineers
    description = #LOC_KTT_PARTUPGRADE_DESCRIPTION_SYSTEM // The imagineers have introduced composite materials that have reduced the dry mass of the INSERTSYSTEM!
}
@PARTUPGRADE[tier4StructuralUpgrade]:NEEDS[Squad]
{
    @title ^= :INSERTPARTTITLE:Tier 4 Structural Parts:
    @description ^= :INSERTSYSTEM:Tier 4 Structural Parts:
}
@PART[*]:HAS[#kiwiStructuralUpgradeType[tier4],~structuralUpgrade[off]]:FOR[zzzKiwiTechTree]
{
    %descriptionUpgrade = #LOC_KTT_PART_DESCRIPTIONUPGRADE_SYSTEM // The INSERTSYSTEMUPGRADENAME has upgrades in INSERTSYSTEMUPGRADENODE!
    @description = #$description$ \n\n<color=#ff0000>$descriptionUpgrade$</color>
    @description ^= :INSERTSYSTEMUPGRADENAME:Tier 4 Structural Parts:
    @description ^= :INSERTSYSTEMUPGRADENODE:Specialized Construction (Tier 6):
}
PARTUPGRADE:NEEDS[Squad]
{
    type = structural
    name = tier5StructuralUpgrade
    partIcon = winglet
    techRequired = advMetalworks
    entryCost = 300000
    cost = 0
    title = #LOC_KTT_PARTUPGRADE_TITLE_SYSTEM // INSERTPARTTITLE Upgrade
    basicInfo = #LOC_KTT_PARTUPGRADE_BASICINFO_SYSTEM // Decrease in Dry Mass
    manufacturer = #LOC_KTT_PARTUPGRADE_MANUFACTURER // Kiwi Imagineers
    description = #LOC_KTT_PARTUPGRADE_DESCRIPTION_SYSTEM // The imagineers have introduced composite materials that have reduced the dry mass of the INSERTSYSTEM!
}
@PARTUPGRADE[tier5StructuralUpgrade]:NEEDS[Squad]
{
    @title ^= :INSERTPARTTITLE:Tier 5 Structural Parts:
    @description ^= :INSERTSYSTEM:Tier 5 Structural Parts:
}
@PART[*]:HAS[#kiwiStructuralUpgradeType[tier5],~structuralUpgrade[off]]:FOR[zzzKiwiTechTree]
{
    %descriptionUpgrade = #LOC_KTT_PART_DESCRIPTIONUPGRADE_SYSTEM // The INSERTSYSTEMUPGRADENAME has upgrades in INSERTSYSTEMUPGRADENODE!
    @description = #$description$ \n\n<color=#ff0000>$descriptionUpgrade$</color>
    @description ^= :INSERTSYSTEMUPGRADENAME:Tier 5 Structural Parts:
    @description ^= :INSERTSYSTEMUPGRADENODE:Advanced MetalWorks (Tier 7):
}
PARTUPGRADE:NEEDS[Squad]
{
    type = structural
    name = tier6StructuralUpgrade
    partIcon = winglet
    techRequired = nanolathing
    entryCost = 400000
    cost = 0
    title = #LOC_KTT_PARTUPGRADE_TITLE_SYSTEM // INSERTPARTTITLE Upgrade
    basicInfo = #LOC_KTT_PARTUPGRADE_BASICINFO_SYSTEM // Decrease in Dry Mass
    manufacturer = #LOC_KTT_PARTUPGRADE_MANUFACTURER // Kiwi Imagineers
    description = #LOC_KTT_PARTUPGRADE_DESCRIPTION_SYSTEM // The imagineers have introduced composite materials that have reduced the dry mass of the INSERTSYSTEM!
}
@PARTUPGRADE[tier6StructuralUpgrade]:NEEDS[Squad]
{
    @title ^= :INSERTPARTTITLE:Tier 6 Structural Parts:
    @description ^= :INSERTSYSTEM:Tier 6 Structural Parts:
}
@PART[*]:HAS[#kiwiStructuralUpgradeType[tier6],~structuralUpgrade[off]]:FOR[zzzKiwiTechTree]
{
    %descriptionUpgrade = #LOC_KTT_PART_DESCRIPTIONUPGRADE_SYSTEM // The INSERTSYSTEMUPGRADENAME has upgrades in INSERTSYSTEMUPGRADENODE!
    @description = #$description$ \n\n<color=#ff0000>$descriptionUpgrade$</color>
    @description ^= :INSERTSYSTEMUPGRADENAME:Tier 6 Structural Parts:
    @description ^= :INSERTSYSTEMUPGRADENODE:Nanolathing (Tier 8):
}
PARTUPGRADE:NEEDS[Squad]
{
    type = structural
    name = tier7StructuralUpgrade
    partIcon = winglet
    techRequired = exoticAlloys
    entryCost = 600000
    cost = 0
    title = #LOC_KTT_PARTUPGRADE_TITLE_SYSTEM // INSERTPARTTITLE Upgrade
    basicInfo = #LOC_KTT_PARTUPGRADE_BASICINFO_SYSTEM // Decrease in Dry Mass
    manufacturer = #LOC_KTT_PARTUPGRADE_MANUFACTURER // Kiwi Imagineers
    description = #LOC_KTT_PARTUPGRADE_DESCRIPTION_SYSTEM // The imagineers have introduced composite materials that have reduced the dry mass of the INSERTSYSTEM!
}
@PARTUPGRADE[tier7StructuralUpgrade]:NEEDS[Squad]
{
    @title ^= :INSERTPARTTITLE:Tier 7 Structural Parts:
    @description ^= :INSERTSYSTEM:Tier 7 Structural Parts:
}
@PART[*]:HAS[#kiwiStructuralUpgradeType[tier7],~structuralUpgrade[off]]:FOR[zzzKiwiTechTree]
{
    %descriptionUpgrade = #LOC_KTT_PART_DESCRIPTIONUPGRADE_SYSTEM // The INSERTSYSTEMUPGRADENAME has upgrades in INSERTSYSTEMUPGRADENODE!
    @description = #$description$ \n\n<color=#ff0000>$descriptionUpgrade$</color>
    @description ^= :INSERTSYSTEMUPGRADENAME:Tier 7 Structural Parts:
    @description ^= :INSERTSYSTEMUPGRADENODE:Exotic Alloys (Tier 9):
}
PARTUPGRADE:NEEDS[Squad]
{
    type = structural
    name = tier8StructuralUpgrade
    partIcon = winglet
    techRequired = aerographite
    entryCost = 800000
    cost = 0
    title = #LOC_KTT_PARTUPGRADE_TITLE_SYSTEM // INSERTPARTTITLE Upgrade
    basicInfo = #LOC_KTT_PARTUPGRADE_BASICINFO_SYSTEM // Decrease in Dry Mass
    manufacturer = #LOC_KTT_PARTUPGRADE_MANUFACTURER // Kiwi Imagineers
    description = #LOC_KTT_PARTUPGRADE_DESCRIPTION_SYSTEM // The imagineers have introduced composite materials that have reduced the dry mass of the INSERTSYSTEM!
}
@PARTUPGRADE[tier8StructuralUpgrade]:NEEDS[Squad]
{
    @title ^= :INSERTPARTTITLE:Tier 8 Structural Parts:
    @description ^= :INSERTSYSTEM:Tier 8 Structural Parts:
}
@PART[*]:HAS[#kiwiStructuralUpgradeType[tier8],~structuralUpgrade[off]]:FOR[zzzKiwiTechTree]
{
    %descriptionUpgrade = #LOC_KTT_PART_DESCRIPTIONUPGRADE_SYSTEM // The INSERTSYSTEMUPGRADENAME has upgrades in INSERTSYSTEMUPGRADENODE!
    @description = #$description$ \n\n<color=#ff0000>$descriptionUpgrade$</color>
    @description ^= :INSERTSYSTEMUPGRADENAME:Tier 8 Structural Parts:
    @description ^= :INSERTSYSTEMUPGRADENODE:Aerographite (Tier 10):
}
PARTUPGRADE:NEEDS[Squad]
{
    type = structural
    name = tier9StructuralUpgrade
    partIcon = winglet
    techRequired = bioActivatedAerographite
    entryCost = 1000000
    cost = 0
    title = #LOC_KTT_PARTUPGRADE_TITLE_SYSTEM // INSERTPARTTITLE Upgrade
    basicInfo = #LOC_KTT_PARTUPGRADE_BASICINFO_SYSTEM // Decrease in Dry Mass
    manufacturer = #LOC_KTT_PARTUPGRADE_MANUFACTURER // Kiwi Imagineers
    description = #LOC_KTT_PARTUPGRADE_DESCRIPTION_SYSTEM // The imagineers have introduced composite materials that have reduced the dry mass of the INSERTSYSTEM!
}
@PARTUPGRADE[tier9StructuralUpgrade]:NEEDS[Squad]
{
    @title ^= :INSERTPARTTITLE:Tier 9+ Structural Parts:
    @description ^= :INSERTSYSTEM:Tier 9+ Structural Parts:
}
@PART[*]:HAS[#kiwiStructuralUpgradeType[tier9],~structuralUpgrade[off]]:FOR[zzzKiwiTechTree]
{
    %descriptionUpgrade = #LOC_KTT_PART_DESCRIPTIONUPGRADE_SYSTEM // The INSERTSYSTEMUPGRADENAME has upgrades in INSERTSYSTEMUPGRADENODE!
    @description = #$description$ \n\n<color=#ff0000>$descriptionUpgrade$</color>
    @description ^= :INSERTSYSTEMUPGRADENAME:Tier 9+ Structural Parts:
    @description ^= :INSERTSYSTEMUPGRADENODE:Bio-Activated Aerographite (Tier 11):
}
